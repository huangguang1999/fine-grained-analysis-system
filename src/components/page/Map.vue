<template>
  <div>
      <div id="container"></div>
  </div>
</template>

<script>
export default {
  data: function () {
    return {
    }
  },
  mounted () {
    this.resize()
    this.initMap()
  },
  methods: {
    initMap () {
      // eslint-disable-next-line no-undef
      var map = new AMap.Map('container', {
        zoom: 4
      })

      // eslint-disable-next-line no-undef
      AMapUI.load(['ui/misc/PathSimplifier', 'lib/$'], function (PathSimplifier, $) {
        if (!PathSimplifier.supportCanvas) {
          alert('当前环境不支持 Canvas！')
          return
        }

        var pathSimplifierIns = new PathSimplifier({
          zIndex: 100,
          // autoSetFitView:false,
          map: map, // 所属的地图实例

          getPath: function (pathData, pathIndex) {
            return pathData.path
          },
          getHoverTitle: function (pathData, pathIndex, pointIndex) {
            if (pointIndex >= 0) {
              // point
              return pathData.name + '，点：' + pointIndex + '/' + pathData.path.length
            }

            return pathData.name + '，点数量' + pathData.path.length
          },
          renderOptions: {

            renderAllPointsIfNumberBelow: 100 // 绘制路线节点，如不需要可设置为-1
          }
        })

        window.pathSimplifierIns = pathSimplifierIns

        // 设置数据
        pathSimplifierIns.setData([{
          name: '路线0',
          path: [
            [123.0201569, 41.98868179],
            [122.995697, 41.97851181],
            [122.995697, 41.97851181],
            [123.0349503, 41.96205902],
            [123.0454865, 41.98709106],
            [123.1221466, 41.9006691],
            [123.013298, 41.95848083],
            [123.013298, 41.95848083],
            [123.0633774, 41.91463089],
            [123.0633774, 41.91463089],
            [123.0257492, 41.95175934],
            [123.0257492, 41.95175934],
            [123.1096497, 41.91384888],
            [123.1096497, 41.91384888],
            [123.0781479, 41.91104126],
            [123.0617218, 41.92488098],
            [123.0617218, 41.92488098],
            [123.0857162, 41.91783142]
          ]
        },
        {
          name: '路线1',
          path: [
            [123.3313904, 41.66542053],
            [123.3639603, 41.66891861],
            [123.3639603, 41.66891861],
            [123.3639603, 41.66891861],
            [123.37603, 41.67359161],
            [123.3758926, 41.67221069],
            [123.3312683, 41.65755081],
            [123.3383789, 41.65644836],
            [123.3318634, 41.65655136],
            [123.3318634, 41.65655136],
            [123.3321228, 41.65560913],
            [123.3321228, 41.65560913],
            [123.3468475, 41.65766144],
            [123.3453903, 41.6604805],
            [123.3776932, 41.68130112],
            [123.3732529, 41.66904831],
            [123.3343735, 41.67208099],
            [123.3238373, 41.65752029],
            [123.3238373, 41.65752029],
            [123.3417969, 41.66085815],
            [123.3417969, 41.66085815],
            [123.3417969, 41.66085815],
            [123.3417969, 41.66085815],
            [123.3417969, 41.66085815],
            [123.3346634, 41.66479874],
            [123.3346634, 41.66479874],
            [123.3662796, 41.68146133],
            [123.3458176, 41.6639595],
            [123.3458176, 41.6639595],
            [123.3458176, 41.6639595],
            [123.3458176, 41.6639595],
            [123.3458176, 41.6639595],
            [123.3636703, 41.67567825],
            [123.3443604, 41.65753174],
            [123.3482819, 41.66563034],
            [123.3495331, 41.66714859],
            [123.3486404, 41.66754913],
            [123.3471069, 41.66733932]
          ]
        },
        {
          name: '路线2',
          path: [
            [123.4183426, 42.38050842],
            [123.4083099, 42.2981987],
            [123.4024124, 42.27907944],
            [123.4163818, 42.28546906],
            [122.7451477, 42.19039917],
            [122.746582, 42.17193985],
            [122.746582, 42.16333008]
          ]
        },
        {
          name: '路线3',
          path: [
            [123.3412704, 41.81267929],
            [123.3412094, 41.77822876],
            [123.3412094, 41.77822876],
            [123.3412094, 41.77822876],
            [123.3435593, 41.7845192],
            [123.3326492, 41.78289032],
            [123.35466, 41.79874039],
            [123.35466, 41.79874039],
            [123.35466, 41.79874039],
            [123.3525925, 41.81206131],
            [123.3525925, 41.81206131],
            [123.3297577, 41.79167938],
            [123.3360519, 41.80081177],
            [123.3360519, 41.80081177],
            [123.3360519, 41.80081177],
            [123.3488464, 41.79114151],
            [123.3488464, 41.79114151],
            [123.3488464, 41.79114151],
            [123.3488464, 41.79114151],
            [123.3232727, 41.78615189],
            [123.3410873, 41.80221176],
            [123.3471985, 41.78953934],
            [123.3471985, 41.78953934],
            [123.3471985, 41.78953934],
            [123.3436737, 41.78839111],
            [123.3436737, 41.78839111],
            [123.3436737, 41.78839111],
            [123.3493729, 41.79272079],
            [123.3353424, 41.80545044],
            [123.3465195, 41.79853058],
            [123.3511581, 41.81327057],
            [123.3350372, 41.80302811],
            [123.3462982, 41.78725052],
            [123.3462982, 41.78725052],
            [123.3412476, 41.78841019],
            [123.3425217, 41.79898071],
            [123.3260727, 41.78894043],
            [123.3260727, 41.78894043],
            [123.3260727, 41.78894043],
            [123.3355789, 41.79264832],
            [123.3355789, 41.79264832],
            [123.3355789, 41.79264832],
            [123.3349609, 41.79600906],
            [123.3501892, 41.79389191],
            [123.3501892, 41.79389191],
            [123.3501892, 41.79389191],
            [123.3501892, 41.79389191],
            [123.3495178, 41.79727936],
            [123.3495178, 41.79727936],
            [123.3480301, 41.79275894],
            [123.3480301, 41.79275894],
            [123.3579788, 41.80804825],
            [123.3481064, 41.80242157],
            [123.3481064, 41.80242157],
            [123.3481064, 41.80242157],
            [123.3481064, 41.80242157],
            [123.3548279, 41.8058815],
            [123.3421097, 41.78033066],
            [123.3425217, 41.79898071],
            [123.3425217, 41.79898071],
            [123.3437576, 41.8087883],
            [123.3396072, 41.78351974],
            [123.3396072, 41.78351974],
            [123.3356934, 41.78720856],
            [123.3356934, 41.78720856],
            [123.335289, 41.80847168],
            [123.338501, 41.78116989],
            [123.3462982, 41.78725052],
            [123.3462982, 41.78725052],
            [123.3462982, 41.78725052],
            [123.3363037, 41.7909584],
            [123.3315506, 41.78979111]
          ]
        },
        {
          name: '路线4',
          path: [
            [123.1857224, 41.76622009],
            [123.2398529, 41.7648201],
            [123.1757584, 41.75733185],
            [123.1874008, 41.77779007],
            [123.1847229, 41.75967026],
            [123.2273483, 41.76507187],
            [123.2182083, 41.85871124],
            [123.1681519, 41.75511169],
            [123.1947632, 41.79299164],
            [123.2398911, 41.7985611],
            [123.2186127, 41.87506866],
            [123.1767197, 41.7659111],
            [123.318222, 41.89696884],
            [123.1914215, 41.82538986],
            [123.2350616, 41.76229858],
            [123.2181168, 41.78538895],
            [123.2343063, 41.78770828],
            [123.1880798, 41.76995087],
            [123.1894608, 41.78302002],
            [123.2530518, 41.79824066],
            [123.2509003, 41.7915802],
            [123.1989288, 41.83605957],
            [123.1963196, 41.87314987],
            [123.1976089, 41.76462173],
            [123.1976089, 41.76462173],
            [123.2036438, 41.78199005],
            [123.2430496, 41.89614868],
            [123.1672897, 41.76432037],
            [123.2430191, 41.85911942],
            [123.2430191, 41.85911942],
            [123.174057, 41.74967957],
            [123.174057, 41.74967957],
            [123.2387695, 41.79053116],
            [123.2387695, 41.79053116]
          ]
        },
        {
          name: '路线5',
          path: [
            [122.8400497, 41.60472107],
            [122.8896332, 41.51470947],
            [122.8896332, 41.51470947],
            [122.8896332, 41.51470947],
            [122.9327164, 41.5591011],
            [122.8392563, 41.57275009],
            [122.8392563, 41.57275009],
            [122.9904327, 41.67195892],
            [122.8493805, 41.590271],
            [122.9067917, 41.52077866],
            [122.8741531, 41.50146866],
            [122.8960876, 41.51839828],
            [122.8960876, 41.51839828],
            [122.8960876, 41.51839828],
            [122.8947372, 41.51762009]
          ]
        },
        {
          name: '路线6',
          path: [
            [123.5331573, 41.9557991],
            [123.5568008, 41.93996811],
            [123.5239487, 41.95082092],
            [123.5547409, 41.94411087],
            [123.4892731, 41.95643997],
            [123.5131226, 41.93125916],
            [123.5317078, 41.9632988],
            [123.5317078, 41.9632988]
          ]
        },
        {
          name: '路线7',
          path: [
            [122.8334122, 41.99530029],
            [122.8420715, 41.99190903],
            [122.8992233, 42.02447891],
            [122.8992233, 42.02447891],
            [122.8992233, 42.02447891],
            [122.9704895, 41.99243164],
            [122.8331604, 42.01269913],
            [122.9195099, 42.03261948],
            [122.8467484, 42.00730133],
            [122.9420471, 42.01485825],
            [122.9420471, 42.01485825],
            [122.8334885, 42.00144958],
            [122.8413925, 41.99573898],
            [122.8239136, 42.01221848],
            [122.8788223, 42.04098892],
            [122.8297577, 41.9962883],
            [122.9983902, 42.02111053],
            [122.9983902, 42.02111053],
            [122.8348236, 41.99364853],
            [122.8348236, 41.99364853],
            [122.8337021, 41.99782181],
            [122.9729919, 41.97909927],
            [122.9729919, 41.97909927],
            [122.8111191, 42.0118103]
          ]
        },
        {
          name: '路线8',
          path: [
            [123.4670715, 41.83361053],
            [123.4670715, 41.83361053],
            [123.4670715, 41.83361053],
            [123.4689713, 41.83068848],
            [123.4689713, 41.83068848],
            [123.4746933, 41.83179855],
            [123.4746933, 41.83179855],
            [123.4746933, 41.83179855],
            [123.4603119, 41.83588028],
            [123.4620132, 41.82012939],
            [123.4764099, 41.82775116],
            [123.4572067, 41.81924057],
            [123.4572067, 41.81924057],
            [123.4572067, 41.81924057],
            [123.4569016, 41.82500839],
            [123.4569016, 41.82500839],
            [123.4618225, 41.82878113],
            [123.4793472, 41.82582092],
            [123.4793472, 41.82582092],
            [123.4685211, 41.82378006],
            [123.4844284, 41.83274078],
            [123.464241, 41.83036041],
            [123.464241, 41.83036041],
            [123.464241, 41.83036041],
            [123.4603577, 41.83380127]
          ]
        },
        {
          name: '路线9',
          path: [
            [123.4927902, 41.76731873],
            [123.4787369, 41.76787949],
            [123.4925919, 41.76272964],
            [123.4865189, 41.76546097],
            [123.4738388, 41.76929092],
            [123.4738388, 41.76929092],
            [123.4809418, 41.76776886]
          ]
        }])

        // 对第一条线路（即索引 0）创建一个巡航器
        for (let i = 0; i < 10; i++) {
          let navgName = 'navg' + (i + 1)
          navgName = pathSimplifierIns.createPathNavigator(i, {
            loop: true, // 循环播放
            speed: 10000 // 巡航速度，单位千米/小时
          })
          navgName.start()
        }
      })
    },
    resize () {
      // const canvas = document.getElementById('container')
      // const ctx = canvas.getContext('2d')
      // canvas.setAttribute('width', window.innerWidth + '')
      // canvas.setAttribute('height', window.innerHeight + '')
    }
  }
}
</script>

<style scoped>
  #container {
    width: 100%;
    height: 1000px;
  }
</style>
